import{_ as A}from"./DzqLuhwg.js";import{a as N,b as U,_ as B}from"./Bb9h3meE.js";import{V as E,_ as O}from"./2kKRVp0V.js";import{u as K,a as R}from"./Syim7y3-.js";import{u as F}from"./BrD182N4.js";import{k as G,r as d,G as D,l as L,d as z,w as Y,o as b,c as j,b as o,e as a,a as s,q as x,h as q,f as V,t as _,i as S,V as H,n as J}from"./DJttfA2y.js";import{c as Q,V as W,a as X}from"./Dzu_wXMV.js";import{a as C,V as w}from"./7ftiKDeA.js";import{V as Z}from"./CzlNXVPV.js";import{V as ee}from"./CVnQGCq2.js";import"./DL4mWp1P.js";import"./C8FhHvjV.js";import"./xai_WGlR.js";import"./ZiKJS9_e.js";import"./vyc2pW3z.js";import"./DRNfISTD.js";import"./DY7PVvcf.js";import"./DbNtUKZG.js";import"./C-GTDzx5.js";import"./DsVMKel3.js";/* empty css        */import"./C7f_LEd8.js";const te=G("stockmovements",()=>{const c=d([]),v=d(0),i=d(!1),t=L(),u=d(""),p=d({page:1,itemsPerPage:10,sortBy:[],sortDesc:[],groupBy:[],depo_id:0,search:""});async function y(){i.value=!0,u.value="",await t(`/api/stockmovements?page=${p.value.page}&per_page=${p.value.itemsPerPage}&depo_id=${p.value.depo_id}&search=${p.value.search}`).then(l=>{i.value=!1,c.value=l.data,v.value=l.total}).catch(l=>{i.value=!1,u.value=l.message})}async function g(l){i.value=!0,u.value="",await t(`/api/deleteStockMovement/${l}`,{method:"DELETE"}).then(()=>{i.value=!1;const h=c.value.findIndex(r=>r.id===l);h!==-1&&c.value.splice(h,1)}).catch(h=>{i.value=!1,u.value=h.message})}const k=D(()=>c.value.filter(l=>l.type==="IN")),f=D(()=>c.value.filter(l=>l.type==="OUT"));return{totalItems:v,loading:i,options:p,fetchData:y,error:u,stockmovements:c,stockInMovements:k,stockOutMovements:f,deleteStockMovement:g}}),ae={class:"d-flex flex-column ms-3"},oe={class:"d-block font-weight-medium text-high-emphasis text-truncate"},se={class:"d-flex gap-2"},le={class:"d-flex gap-2"},ne={class:"d-flex gap-2"},ie=z({__name:"StockMovements",async setup(c){let v,i;const t=te(),u=K(),p=F();[v,i]=Y(()=>R("depo",()=>u.getAllDepos())),await v,i();const y=[{title:"Ürün Kodu",key:"productCode"},{title:"Depo",key:"depo"},{title:"Raf No",key:"raf"},{title:"Durum",key:"stock"},{title:"Tarih",key:"date"},{title:"Aksiyonlar",key:"actions"}],g=d(""),k=d(null),f=d(!1),l=async m=>{t.options.depo_id=m??0,t.fetchData()},h=m=>{t.options.page=m.page??0,t.options.search=m.search??"",t.options.depo_id=k.value??0,t.fetchData()},r=d({deger:"",item:0,title:"",message:""}),P=(m,n)=>{r.value.deger=m,r.value.item=n.id,r.value.title="Emin misiniz?",r.value.message="Stok hareketi silme işlemi geri alınamaz ve ürünün stoğu da eski haline güncellenecektir.",f.value=!0},M=async m=>{m.deger==="delete"&&await t.deleteStockMovement(m.item).then(()=>{f.value=!1,p.stockmovements=[]})};return(m,n)=>{const T=A,$=B,I=O;return b(),j(X,null,{default:o(()=>[a(Q,{class:"d-flex align-center pe-2"}),a(w,null,{default:o(()=>[a(T,{modelValue:s(t).loading,"onUpdate:modelValue":n[0]||(n[0]=e=>s(t).loading=e)},null,8,["modelValue"]),a($,{modelValue:s(f),"onUpdate:modelValue":n[1]||(n[1]=e=>x(f)?f.value=e:null),deger:s(r).deger,item:s(r).item,title:s(r).title,message:s(r).message,onClickedAgree:M},null,8,["modelValue","deger","item","title","message"]),a(C,{cols:"12",md:"12","order-md":"0",order:"1"},{default:o(()=>[a(W,{class:"pt-0"},{default:o(()=>[a(Z,{onSubmit:q(()=>{},["prevent"])},{default:o(()=>[a(w,null,{default:o(()=>[a(C,{cols:"12",md:"3"},{default:o(()=>[a(N,{modelValue:s(k),"onUpdate:modelValue":[n[2]||(n[2]=e=>x(k)?k.value=e:null),l],items:s(u).depo,label:"Malzeme listesini görmek istediğiniz depoyu seçiniz.",placeholder:"Depo Seç","item-title":"name","item-value":"id",clearable:""},null,8,["modelValue","items"])]),_:1}),a(C,{cols:"12",md:"3"},{default:o(()=>[a(ee,{modelValue:s(g),"onUpdate:modelValue":n[3]||(n[3]=e=>x(g)?g.value=e:null),label:"Ürün Kodu",type:"text",placeholder:"Ürün Koduna Göre Arama Yapın",clearable:"","prepend-inner-icon":"ri-user-line"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(I,null,{default:o(()=>[a(E,{"items-per-page":s(t).options.itemsPerPage,"onUpdate:itemsPerPage":n[4]||(n[4]=e=>s(t).options.itemsPerPage=e),headers:y,items:s(t).stockmovements,"items-length":s(t).totalItems,loading:s(t).loading,search:s(g),"item-value":"id",class:"text-no-wrap","onUpdate:options":h},{"item.productCode":o(({item:e})=>[V("div",ae,[V("span",oe,_(e.malzemos.productCode),1),V("small",null,_(e.malzemos.productDesc),1)])]),"item.raf":o(({item:e})=>[V("div",se,_(e.malzemos.raf.name),1)]),"item.depo":o(({item:e})=>[V("div",le,_(e.malzemos.raf.descendants.name),1)]),"item.stock":o(({item:e})=>[a(U,{color:e.type==="IN"?"success":"error",class:"font-weight-medium",size:"small"},{default:o(()=>[S(_(e.type==="IN"?"+":"-")+" "+_(e.stock),1)]),_:2},1032,["color"])]),"item.date":o(({item:e})=>[S(_(e.created_at),1)]),"item.actions":o(({item:e})=>[V("div",ne,[a(H,{icon:"ri-close-circle-line",size:"22",onClick:re=>P("delete",e)},null,8,["onClick"])])]),_:1},8,["items-per-page","items","items-length","loading","search"])]),_:1})]),_:1})}}}),Te=z({__name:"stock-moevements",setup(c){return(v,i)=>(b(),J("div",null,[a(ie)]))}});export{Te as default};
